---
title: Fyrirlestur 9.2 ‚Äî React
---

# Fyrirlestur 9.2

## React

### Vefforritun 2 ‚Äî HBV403G

#### √ìlafur Sverrir Kjartansson, [osk@hi.is](mailto:osk@hi.is)

---

## Sta√∞a √≠ st√¶rri forritum

* St√¶rri forrit √æurfa yfirleitt a√∞ deila st√∂√∞u √° milli hluta
  - Er notandi innskr√°√∞ur? Er b√∫i√∞ a√∞ s√¶kja g√∂gn?
* Ein lei√∞ er a√∞ ‚Äûlyfta st√∂√∞u‚Äú upp tr√©√∞ og l√°ta sameiginlegt foreldri sj√° um st√∂√∞u fyrir systkini

***

* Sendum f√∂ll √° milli sem b√∂rn kalla √≠ til a√∞ uppf√¶ra st√∂√∞u foreldris sem s√≠√∞an sendir sem prop til annara
  - Getum samt lent √≠ vandr√¶√∞um, hvar h√¶ttum vi√∞? Vita allir af √∂llu?
* Hugtaki√∞ um ‚Äûsingle source of truth‚Äú er mikilv√¶gt √≠ react
  - √ûurfum e.t.v. a√∞ skrifa meiri k√≥√∞a en f√°um f√¶rri b√∂gga √° m√≥ti

***

## D√¶mi

[React Docs: Lifting State Up](https://reactjs.org/docs/lifting-state-up.html)

---

## Composition og inheritance

* √ç react notum vi√∞ composition √≠ sta√∞inn fyrir inheritance
* Eina sem vi√∞ `extend`um er `Component` e√∞a `PureComponent`
  - B√∫um **aldrei** til okkar eigin yfir klasa og gerum `extends MyComponent`

***

## Containment

* Sum component vita ekki hva√∞ √æau munu innihalda
* S√©rstaklega gener√≠sk component fyrir ‚Äûbox‚Äú
* √ûau √¶ttu a√∞ nota `children` til a√∞ skrifa √∫t b√∂rn

***

```javascript
function FancyBorder(props) {
  const className =
    `FancyBorder FancyBorder-${color}`;

  return (
    <div className={className}>
      {props.children}
    </div>
  );
}
```

***

```javascript
function WelcomeDialog() {
  return (
    <FancyBorder color="blue">
      <h1 className="Dialog-title">Welcome</h1>
      <p className="Dialog-message">
        Thank you for visiting our spacecraft!
      </p>
    </FancyBorder>
  );
}
```

***

## S√©rh√¶fing

* Ef vi√∞ viljum endurn√Ωta getum vi√∞ nota√∞ s√©rh√¶fingu
* √ötb√∫um almennan component
* √ötb√∫um s√©rh√¶f√∞ tilvik

***

```javascript
function Dialog(props) {
  return (
    <FancyBorder color="blue">
      <h1 className="Dialog-title">
        {props.title}
      </h1>
      <p className="Dialog-message">
        {props.message}
      </p>
    </FancyBorder>
  );
}
```

***

```javascript
function WelcomeDialog() {
  const message =
    'Thank you for visiting our spacecraft!';

  return (
    <Dialog
      title="Welcome"
      message={message}
    />
  );
}
```

***

> At Facebook, we use React in thousands of components, and we haven‚Äôt found any use cases where we would recommend creating component inheritance hierarchies.

‚Äî [React docs](https://reactjs.org/docs/composition-vs-inheritance.html)

***

> Favor object composition over class inheritance.

‚Äî [GoF: ‚ÄúDesign Patterns‚Äù](https://en.wikipedia.org/wiki/Composition_over_inheritance)

---

## S√©rh√¶fing √° st√≠lum

* Ef vi√∞ h√∂fum `<Button>` component sem hefur s√Ωna eigin grunnst√≠la getum vi√∞ √æurft a√∞ s√©rh√¶fa √∫tlit
  - T.d. √≠ formi √æurfum vi√∞ a√∞ f√¶ra hann a√∞eins ni√∞ur e√∞a til hli√∞ar
* `<Button>` hefur sitt eigi√∞ `className` en tekur vi√∞ √∂√∞rum √≠ gegnum `prop`, b√¶√∞i eru s√≠√∞an notu√∞

***

```javascript
import './Button.css';

export default class Button extends Component {
  render() {
    const { children, className } = this.props;
    const classes = `button ${className}`;

    return (
      <button className={classes}>
        {children}
      </button>
    );
  }
}
```

***

```javascript
import './Form.css';

const form = (
  <form>
    <Button className="form__button">
      takki
    </Button>
  </form>
);
```

```html
<form>
  <button class="button form__button">
    takki
  </button>
</form>
```

***

## Classnames

* [`classnames`](https://github.com/JedWatson/classnames) er pakki sem getur hj√°lpa√∞ vi√∞ a√∞ √∫tb√∫a √æessa strengi
* Tekur vi√∞ allskonar arguments og skilar streng

***

* `classNames({ foo: true }, { bar: true });`
  - `// => 'foo bar'`
* `classNames('foo', { bar: true, duck: false }, 'baz', { quux: true });`
  - `// => 'foo bar baz quux'`

---

## DOM

* Stundum √æurfum vi√∞ a√∞ gera eitthva√∞ fyrir utan react, nota _imperative_ API
  - t.d. kalla √≠ `open()` e√∞a `close()` √≠ sta√∞inn fyrir a√∞ geta sent `isOpen={true}`
* Getum √æurft ef vi√∞ erum a√∞ sj√° sj√°lf um f√≥kus (`focus` og `blur`), spila v√≠deo, keyra kvikun o.fr.

***

## Ref

* `ref` er lei√∞ til a√∞ f√° v√≠sun DOM element
* B√∫um til breytu fyrir `ref` √≠ `constructor` me√∞ √æv√≠ a√∞ kalla √≠ `React.createRef()`
  - `this.inputRef = React.createRef();`

***

* Skilgreinum v√≠sun √≠ √æessa breytu me√∞ `ref` attribute √° n√≥√∞u
  - `<input ref={this.inputRef} />`
* N√°lgumst v√≠sun √≠ gegnum `current` attribute
  - `this.inputRef.current`

***

* Virkar ekki fyrir functional componenta
* Ef vi√∞ erum a√∞ nota `ref` miki√∞ g√¶ti veri√∞ a√∞ vi√∞ s√©um ekki a√∞ skrifa componenta eftir _react lei√∞inni_

***

```javascript
class CustomTextInput extends Component {
  constructor(props) {
    super(props);
    this.inputRef = React.createRef();
  }
  focus = ()=> { this.inputRef.current.focus(); }
  render() {
    return (
      <div>
        <input type="text" ref={this.inputRef} />
        <button onClick={this.focus}>üôÄ</button>
      </div>
    );
} }
```

***

## Uncontrolled components

* Ef vi√∞ st√Ωrum ekki gildi forma me√∞ react h√∂fum vi√∞ _uncontrolled component_
* Notum `ref` til a√∞ n√°lgast gildi√∞ √∫r DOM
* Ef vi√∞ viljum setja gildi √≠ byrjun sem ekki er yfirskrifa√∞ notum vi√∞ `defaultValue`
* `<input type="file">` er alltaf _uncontrolled_

***

## dangerouslySetInnerHTML

* Ef vi√∞ √æurfum a√∞ setja _hr√°tt_ HTML inn er react ekki hrifi√∞ af √æv√≠
* Minnir okkur √° a√∞ √æa√∞ er h√¶ttulegt vegna XSS me√∞ √æv√≠ a√∞ endurnefna `innerHTML` √≠ `dangerouslySetInnerHTML` og gera erfitt
* `<div dangerouslySetInnerHTML={{__html: 'First &middot; Second'}} />;`
