---
title: Fyrirlestur 8.3 ‚Äî React
---

# Fyrirlestur 8.3

## React

### Vefforritun 2 ‚Äî HBV403G

#### √ìlafur Sverrir Kjartansson, [osk@hi.is](mailto:osk@hi.is)

---

## State

* Keiml√≠kt `props` en er pr√≠vat fyrir component
  - Ekki read-only
* Stj√≥rna√∞ af component a√∞ √∂llu leiti
* A√∞eins til sta√∞ar ef component skilgreint sem `class`*
* √Üttum a√∞eins a√∞ setja hluti sem ver√∞a birtir √≠ `state`, √∂nnur g√∂gn getum vi√∞ geymt √° `class` me√∞ `this`

***

## Byrjunarsta√∞a

* Setjum `this.state = { ... }` √≠ `contstructor`
* Ef vi√∞ h√∂fum stu√∞ning vi√∞ member breytur sem `state = { ... }` √≠ class (virkar √≠ CRA)
* **Eina skipti√∞** sem vi√∞ setjum `state` beint

***

```javascript
class Foo extends Component {
  constructor(props) {
    super(props);
    this.state = { /* ... */ };
  }
}
```

```javascript
class Foo extends Component {
  state = { /* ... */ };
}
```

***

## Uppf√¶rsla √° `state`

* Uppf√¶rsla √° `state` fer alltaf fram √≠ gegnum `this.setState()`
* Uppf√¶rslur eru keyr√∞ar asynchronously, getum ekki treyst √° a√∞ uppf√¶rsla hafi √°tt s√©r sta√∞ √≠ n√¶stu l√≠nu

***

* Ef vi√∞ viljum b√≠√∞a eftir a√∞ b√∫i√∞ s√© a√∞ setja `state` getum vi√∞ nota√∞ `this.setState((prevState, props) => { /* ... */ })`
* Getum uppf√¶rt einn hlut √≠ st√∂√∞u √≠ einu, √æurfum ekki a√∞ uppf√¶ra allt √≠ einu

***

```javascript
// üëéüèº
this.state.comment = 'Hello';
```

```javascript
// üëçüèº
this.setState({ comment: 'Hello' });
```

***

```javascript
// üëéüèº
this.setState({
  counter: this.state.counter + this.props.incr,
});
```

```javascript
// üëçüèº
this.setState((prevState, props) => ({
  counter: prevState.counter + props.incr,
}));
```

***

## Fl√¶√∞i gagna

* Componentum √° a√∞ vera alveg sama hvort a√∞rir componentar hafi st√∂√∞u e√∞a ekki; s√©u functional e√∞a ekki
* `state` er h√°√∞ √∫tf√¶rslu component og er aldrei a√∞gengilegt √∂√∞rum componentum
  - Nema component sendi part af st√∂√∞u √°fram √≠ _prop_ hj√° √∂√∞rum component

***

## G√∂gn fl√¶√∞a ni√∞ur

* G√∂gn √≠ react fl√¶√∞a alltaf _ni√∞ur_
  - _top-down_ e√∞a _unidirectional_ gagnafl√¶√∞i
* √ûetta vefst fyrir m√∂rgum sem byrja a√∞ nota react
* Vegna reconciliation √∫tf√¶rslu er √≥d√Ωrar fyrir okkur a√∞ teikna *allt* UI aftur en a√∞ breyta √°kve√∞num hlut
  - Eigum aldrei (mj√∂g sjaldan!) a√∞ √æurfa a√∞ nota sj√°lf DOM a√∞ger√∞ir

---

## Atbur√∞ir √≠ react

* Atbur√∞ir √≠ react eru svipa√∞ir DOM atbur√∞um me√∞ sm√° undantekningum
* camelCase og f√∂ll en ekki strengir
* `<button onclick="activateLasers()">` VS `<button onClick={activateLasers}>`
* üò±

***

```javascript
function ActionLink() {
  function handleClick(e) {
    e.preventDefault();
    console.log('The link was clicked.');
  }

  return (
    <a href="#" onClick={handleClick}>
      Click me
    </a>
  );
}
```

***

## A√∞ taka √æ√°tt √≠ atbur√∞um

* √ç react √æurfum vi√∞ yfirleitt ekki a√∞ nota `addEventListener`
* React notar _synthetic events_, ekki _alv√∂ru_ event fr√° browser
* Skr√°um handler beint √≠ JSX og react s√©r um

***

## Synthetic event

* React √∫tf√¶rir eigin events √∫t fr√° W3C spec
  - Getum nota√∞ `e.stopPropagation()` og `e.preventDefault()`
* Endurn√Ωtir events og gerir √Ωmislegt til a√∞ f√° betra performance
* [React: SyntheticEvent](https://reactjs.org/docs/events.html)

***

## Binding

* √ûa√∞ er algengt a√∞ nota class method √æegar vi√∞ skr√°um handler √° class
* Ver√∞um a√∞ passa a√∞ _binda_ r√©tt til √æess a√∞ `this` virki
* Nokkrar lei√∞ir √≠ bo√∞i

***

## Binding lei√∞ir

* Binda √≠ `constructor`
  - `this.handleClick = this.handleClick.bind(this);`
  - Frekar fyrirfer√∞armiki√∞

***

* Binda √≠ event
  - `<button onClick={(e) => this.handleClick(e)}>`
  - Veldur √æv√≠ a√∞ fyrir hvert `render` er b√∫i√∞ til n√Ωtt fall

***

* Nota public class field (ekki or√∞i√∞ sta√∞la√∞)
  - `handleClick = () => { /* ... */ }`
  - √û√¶gileg lei√∞ sem er studd af CRA
  - M√¶li me√∞ a√∞ nota √æessa

***

```javascript
class Foo extends Component {
  handleClick = (e) => {
    console.log(this, e);
  }

  render() {
    return (
      <p>
        <button onClick={this.handleClick}>
          click
        </button>
      </p>
    );
  }
}
```

***

## Argument √≠ event handler

* Til a√∞ senda g√∂gn √≠ event handler getum vi√∞ nota√∞
  - `<button onClick={(e) => this.del(id, e)}>Delete</button>`
  - `<button onClick={this.del.bind(this, id)}>Delete</button>`
  - B√Ωr til n√Ωtt fall vi√∞ hvert render...

***

* E√∞a vi√∞ getum √∫tb√∫i√∞ handler sem skilar _√∂√∞rum_ handler

***

```javascript
handler = (foo) => (e) => {
  e.preventDefault();

  // Lokun (closure) yfir foo
  // foo er a√∞gengilegt √æegar
  // atbur√∞ur √° s√©r sta√∞
}

// ...

return (<button onClick={this.handler('foo')});
```
